

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Contributing to sgkit &mdash; sgkit  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/typehints.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Reading VCF" href="vcf.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> sgkit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="vcf.html">Reading VCF</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contributing to sgkit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#discussion-forums">Discussion forums</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-repositories">Code repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#issues">Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#development-environment">Development environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download-code">Download code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install">Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-tests">Run tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#contributing-to-code">Contributing to code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#continuous-integration">Continuous Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="#docstrings">Docstrings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coding-standards">Coding standards</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pr-git-ops">PR/Git ops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#contributing-to-documentation">Contributing to documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#benchmarks">Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#review-process">Review process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-discussions">Design discussions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dataset-subclassing">Dataset subclassing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dataset-api-typing">Dataset API typing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delayed-invariant-checks">Delayed invariant checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mixed-ploidy">Mixed ploidy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numba-guvectorize-usage">Numba guvectorize usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-namespace">API namespace</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sgkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Contributing to sgkit</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/contributing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="contributing-to-sgkit">
<span id="contributing"></span><h1>Contributing to sgkit<a class="headerlink" href="#contributing-to-sgkit" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of contents:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#discussion-forums" id="id1">Discussion forums</a></p></li>
<li><p><a class="reference internal" href="#code-repositories" id="id2">Code repositories</a></p></li>
<li><p><a class="reference internal" href="#issues" id="id3">Issues</a></p></li>
<li><p><a class="reference internal" href="#development-environment" id="id4">Development environment</a></p>
<ul>
<li><p><a class="reference internal" href="#download-code" id="id5">Download code</a></p></li>
<li><p><a class="reference internal" href="#install" id="id6">Install</a></p></li>
<li><p><a class="reference internal" href="#run-tests" id="id7">Run tests</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#contributing-to-code" id="id8">Contributing to code</a></p>
<ul>
<li><p><a class="reference internal" href="#continuous-integration" id="id9">Continuous Integration</a></p></li>
<li><p><a class="reference internal" href="#test" id="id10">Test</a></p></li>
<li><p><a class="reference internal" href="#docstrings" id="id11">Docstrings</a></p></li>
<li><p><a class="reference internal" href="#coding-standards" id="id12">Coding standards</a></p></li>
<li><p><a class="reference internal" href="#pr-git-ops" id="id13">PR/Git ops</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#contributing-to-documentation" id="id14">Contributing to documentation</a></p></li>
<li><p><a class="reference internal" href="#benchmarks" id="id15">Benchmarks</a></p></li>
<li><p><a class="reference internal" href="#review-process" id="id16">Review process</a></p></li>
<li><p><a class="reference internal" href="#design-discussions" id="id17">Design discussions</a></p>
<ul>
<li><p><a class="reference internal" href="#dataset-subclassing" id="id18">Dataset subclassing</a></p></li>
<li><p><a class="reference internal" href="#dataset-api-typing" id="id19">Dataset API typing</a></p></li>
<li><p><a class="reference internal" href="#delayed-invariant-checks" id="id20">Delayed invariant checks</a></p></li>
<li><p><a class="reference internal" href="#mixed-ploidy" id="id21">Mixed ploidy</a></p></li>
<li><p><a class="reference internal" href="#numba-guvectorize-usage" id="id22">Numba guvectorize usage</a></p></li>
<li><p><a class="reference internal" href="#api-namespace" id="id23">API namespace</a></p></li>
</ul>
</li>
</ul>
</div>
<p>All contributions, bug reports, bug fixes, documentation improvements,
enhancements, and ideas are welcome.
This page provides resources on how best to contribute.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Large parts of this document came from the <a class="reference external" href="https://docs.dask.org/en/latest/develop.html">Dask Development Guidelines</a>.</p>
</div>
<div class="section" id="discussion-forums">
<h2><a class="toc-backref" href="#id1">Discussion forums</a><a class="headerlink" href="#discussion-forums" title="Permalink to this headline">¶</a></h2>
<p>Conversation about <em>sgkit</em> happens in the following places:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/issues">GitHub Issue Tracker</a>: for discussions around new features or bugs</p></li>
<li><p><a class="reference external" href="https://discourse.pystatgen.org/">Python for Statistical Genetics forum</a>: for general discussion</p></li>
</ol>
<p>Discussions on the forum tend to be about higher-level themes, and statistical genetics in
general. Coding details should be discussed on GitHub issues and pull requests.</p>
</div>
<div class="section" id="code-repositories">
<h2><a class="toc-backref" href="#id2">Code repositories</a><a class="headerlink" href="#code-repositories" title="Permalink to this headline">¶</a></h2>
<p>Code and documentation for <em>sgkit</em> is maintained in a few git repositories hosted on the
GitHub <code class="docutils literal notranslate"><span class="pre">pystatgen</span></code> organization, <a class="reference external" href="https://github.com/pystatgen">https://github.com/pystatgen</a>.  This includes the primary
repository and several other repositories for different components.  A
non-exhaustive list follows:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit">https://github.com/pystatgen/sgkit</a>: The main code repository containing the
data representations (in Xarray), algorithms, and most documentation</p></li>
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit-bgen">https://github.com/pystatgen/sgkit-bgen</a>: Code for reading BGEN format files
into <em>sgkit</em>’s Xarray represention</p></li>
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit-plink">https://github.com/pystatgen/sgkit-plink</a>: Code for reading PLINK format files
into <em>sgkit</em>’s Xarray represention</p></li>
</ul>
<p>Git and GitHub can be challenging at first.  Fortunately good materials exist
on the internet.  Rather than repeat these materials here, we refer you to
Pandas’ documentation and links on this subject at
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/contributing.html">https://pandas.pydata.org/pandas-docs/stable/contributing.html</a></p>
</div>
<div class="section" id="issues">
<h2><a class="toc-backref" href="#id3">Issues</a><a class="headerlink" href="#issues" title="Permalink to this headline">¶</a></h2>
<p>The community discusses and tracks known bugs and potential features in the
<a class="reference external" href="https://github.com/pystatgen/sgkit/issues">GitHub Issue Tracker</a>.  If you have a new idea or have identified a bug, then
you should raise it there to start public discussion.</p>
<p>If you are looking for an introductory issue to get started with development,
then check out the <a class="reference external" href="https://github.com/pystatgen/sgkit/labels/good%20first%20issue">“good first issue” label</a>, which contains issues that are good
for starting developers.  Generally, familiarity with Python, NumPy, and
some parallel computing (Dask) are assumed.</p>
<p>Before starting work, make sure there is an issue covering the feature or bug you
plan to produce a pull request for. Assign the issue to yourself to indicate that
you are working on it. In the PR make sure to mention/link the related issue(s).</p>
</div>
<div class="section" id="development-environment">
<h2><a class="toc-backref" href="#id4">Development environment</a><a class="headerlink" href="#development-environment" title="Permalink to this headline">¶</a></h2>
<div class="section" id="download-code">
<h3><a class="toc-backref" href="#id5">Download code</a><a class="headerlink" href="#download-code" title="Permalink to this headline">¶</a></h3>
<p>Make a fork of the main <a class="reference external" href="https://github.com/pystatgen/sgkit">sgkit repository</a> and
clone the fork:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/&lt;</span><span class="n">your</span><span class="o">-</span><span class="n">github</span><span class="o">-</span><span class="n">username</span><span class="o">&gt;/</span><span class="n">sgkit</span>
</pre></div>
</div>
<p>Contributions to <em>sgkit</em> can then be made by submitting pull requests on GitHub.</p>
</div>
<div class="section" id="install">
<h3><a class="toc-backref" href="#id6">Install</a><a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h3>
<p>To build the library you need to first install GSL (GNU Scientific Library),
which is required for <code class="docutils literal notranslate"><span class="pre">msprime</span></code>. Since it’s a system package and installation
may vary depending on the operating system, the instructions for the same can be
found on <a class="reference external" href="https://msprime.readthedocs.io/en/stable/installation.html#installing-system-requirements">msprime docs.</a></p>
<p>You can install rest of the necessary requirements using pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">sgkit</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">-</span><span class="n">dev</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">-</span><span class="n">doc</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Also install pre-commit, which is used to enforce coding standards:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">install</span>
</pre></div>
</div>
</div>
<div class="section" id="run-tests">
<h3><a class="toc-backref" href="#id7">Run tests</a><a class="headerlink" href="#run-tests" title="Permalink to this headline">¶</a></h3>
<p><em>sgkit</em> uses <a class="reference external" href="https://docs.pytest.org/en/latest/">pytest</a> for testing.  You can run tests from the main <code class="docutils literal notranslate"><span class="pre">sgkit</span></code> directory
as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="contributing-to-code">
<h2><a class="toc-backref" href="#id8">Contributing to code</a><a class="headerlink" href="#contributing-to-code" title="Permalink to this headline">¶</a></h2>
<p><em>sgkit</em> maintains development standards that are similar to most PyData projects.  These standards include
language support, testing, documentation, and style.</p>
<div class="section" id="continuous-integration">
<h3><a class="toc-backref" href="#id9">Continuous Integration</a><a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h3>
<p><em>sgkit</em> uses GitHub Actions as a Continuous Integration (CI) service to check code
contributions. Every push to every pull request on GitHub will run the tests,
check test coverage, check coding standards, and check the documentation build.</p>
</div>
<div class="section" id="test">
<h3><a class="toc-backref" href="#id10">Test</a><a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h3>
<p><em>sgkit</em> employs extensive unit tests to ensure correctness of code both for today
and for the future.</p>
<p>Test coverage must be 100% for code to be accepted. You can measure the coverage
on your local machine by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">cov</span><span class="o">=</span><span class="n">sgkit</span> <span class="o">--</span><span class="n">cov</span><span class="o">-</span><span class="n">report</span><span class="o">=</span><span class="n">html</span>
</pre></div>
</div>
<p>A report will be written in the <code class="docutils literal notranslate"><span class="pre">htmlcov</span></code> directory that will show any lines that
are not covered by tests.</p>
<p>The test suite is run automatically by CI.</p>
<p>Test files live in <code class="docutils literal notranslate"><span class="pre">sgkit/tests</span></code> directory, test filename naming convention:
<code class="docutils literal notranslate"><span class="pre">test_&lt;MODULE&gt;.py</span></code>.</p>
<p>Use double underscore to organize tests into groups, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_foo__accepts_empty_input</span><span class="p">():</span>
  <span class="o">...</span>

<span class="k">def</span> <span class="nf">test_foo__accepts_strings</span><span class="p">():</span>
  <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="docstrings">
<h3><a class="toc-backref" href="#id11">Docstrings</a><a class="headerlink" href="#docstrings" title="Permalink to this headline">¶</a></h3>
<p>User facing functions should follow the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html#docstring-standard">numpydoc</a> standard, including
sections for <code class="docutils literal notranslate"><span class="pre">Parameters</span></code>, <code class="docutils literal notranslate"><span class="pre">Examples</span></code>, and general explanatory prose.</p>
<p>The types for parameters and returns should not be added to the docstring,
they should be only added as type hints, to avoid duplication.</p>
<p>A reference for each new public function should be added in the API documentation file
<code class="docutils literal notranslate"><span class="pre">docs/api.rst</span></code>, which makes them accessible on the user documentation page.</p>
<p>By default, examples will be doc-tested.  Reproducible examples in documentation
is valuable both for testing and, more importantly, for communication of common
usage to the user.  Documentation trumps testing in this case and clear
examples should take precedence over using the docstring as testing space.
To skip a test in the examples add the comment <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">doctest:</span> <span class="pre">+SKIP</span></code> directly
after the line.</p>
<p>Docstrings are tested by CI. You can test them locally
by running <code class="docutils literal notranslate"><span class="pre">pytest</span></code> (this works because the <code class="docutils literal notranslate"><span class="pre">--doctest-modules</span></code> option is automatically added
in the <em>setup.cfg</em> file).</p>
</div>
<div class="section" id="coding-standards">
<h3><a class="toc-backref" href="#id12">Coding standards</a><a class="headerlink" href="#coding-standards" title="Permalink to this headline">¶</a></h3>
<p><em>sgkit</em> uses <a class="reference external" href="https://pre-commit.com/">pre-commit</a> to enforce coding standards. Pre-commit
runs when you commit code to your local git repository, and the commit will only succeed
if the change passes all the checks. It is also run for pull requests using CI.</p>
<p><em>sgkit</em> uses the following tools to enforce coding standards:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://black.readthedocs.io/en/stable/">Black</a>: for code formatting</p></li>
<li><p><a class="reference external" href="http://flake8.pycqa.org/en/latest/">Flake8</a>: for style consistency</p></li>
<li><p><a class="reference external" href="https://timothycrosley.github.io/isort/">isort</a>: for import ordering</p></li>
<li><p><a class="reference external" href="http://mypy-lang.org/">mypy</a>: for static type checking</p></li>
</ol>
<p>To manually enforce (or check) the source code adheres to our coding standards without
doing a git commit, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="o">--</span><span class="nb">all</span><span class="o">-</span><span class="n">files</span>
</pre></div>
</div>
<p>To run a specific tool (<code class="docutils literal notranslate"><span class="pre">black</span></code>/<code class="docutils literal notranslate"><span class="pre">flake8</span></code>/<code class="docutils literal notranslate"><span class="pre">isort</span></code>/<code class="docutils literal notranslate"><span class="pre">mypy</span></code> etc):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="n">black</span> <span class="o">--</span><span class="nb">all</span><span class="o">-</span><span class="n">files</span>
</pre></div>
</div>
<p>You can omit <code class="docutils literal notranslate"><span class="pre">--all-files</span></code> to only check changed files.</p>
</div>
<div class="section" id="pr-git-ops">
<h3><a class="toc-backref" href="#id13">PR/Git ops</a><a class="headerlink" href="#pr-git-ops" title="Permalink to this headline">¶</a></h3>
<p>We currently use <code class="docutils literal notranslate"><span class="pre">rebase</span></code> or <code class="docutils literal notranslate"><span class="pre">squash</span></code> PR merge strategies. This means that
following certain git best practices will make your development life easier.</p>
<ol class="arabic">
<li><p>Try to create isolated/single issue PRs</p>
<p>This makes it easier to review your changes, and should guarantee
a speedy review.</p>
</li>
<li><p>Try to push meaningful small commits</p>
<p>Again this makes it easier to review your code, and in case of
bugs easier to isolate specific buggy commits.</p>
</li>
</ol>
<p>Please read <a class="reference external" href="https://git-scm.com/book/en/v2/Distributed-Git-Contributing-to-a-Project#_public_project">git best practices</a>
and specifically a very handy <a class="reference external" href="https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History#_rewriting_history">interactive rebase doc</a>.</p>
</div>
</div>
<div class="section" id="contributing-to-documentation">
<h2><a class="toc-backref" href="#id14">Contributing to documentation</a><a class="headerlink" href="#contributing-to-documentation" title="Permalink to this headline">¶</a></h2>
<p><em>sgkit</em> uses <a class="reference external" href="https://www.sphinx-doc.org/">Sphinx</a> for documentation, hosted at <a class="reference external" href="https://pystatgen.github.io/sgkit/">https://pystatgen.github.io/sgkit/</a>.
Documentation is maintained in the RestructuredText markup language (<code class="docutils literal notranslate"><span class="pre">.rst</span></code>
files) in <code class="docutils literal notranslate"><span class="pre">docs</span></code>.  The documentation consists both of prose
and API documentation.</p>
<p>You can build the documentation locally with <code class="docutils literal notranslate"><span class="pre">make</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">docs</span>
<span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
<p>The resulting HTML files end up in the <code class="docutils literal notranslate"><span class="pre">_build/html</span></code> directory.</p>
<p>You can now make edits to <code class="docutils literal notranslate"><span class="pre">.rst</span></code> files and run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code> again to update
the affected pages.</p>
<p>The documentation build is checked by CI to ensure that it builds
without warnings. You can do that locally with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">clean</span> <span class="n">html</span> <span class="n">SPHINXOPTS</span><span class="o">=</span><span class="s2">&quot;-W --keep-going -n&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="benchmarks">
<h2><a class="toc-backref" href="#id15">Benchmarks</a><a class="headerlink" href="#benchmarks" title="Permalink to this headline">¶</a></h2>
<p><em>sgkit</em> uses <a class="reference external" href="https://www.sphinx-doc.org/">asv</a> (Airspeed Velocity) for micro benchmarking.
Airspeed Velocity manages building the environment via conda itself. The
recipe for the same is defined in the <code class="docutils literal notranslate"><span class="pre">benchmarks/asv.conf.json</span></code>
configuration file. The benchmarks should be written in the <code class="docutils literal notranslate"><span class="pre">benchmarks/</span></code>
directory. For more information on different types of benchmarks have a look
at the <code class="docutils literal notranslate"><span class="pre">asv</span></code> documentation here: <a class="reference external" href="https://asv.readthedocs.io/en/stable/writing_benchmarks.html#writing-benchmarks">https://asv.readthedocs.io/en/stable/writing_benchmarks.html#writing-benchmarks</a></p>
<p>The results of benchmarks are uploaded to benchmarks repository: <a class="reference external" href="https://github.com/pystatgen/sgkit-benchmarks-asv">https://github.com/pystatgen/sgkit-benchmarks-asv</a>
via Github Actions. They can be seen on the static site here: <a class="reference external" href="https://pystatgen.github.io/sgkit-benchmarks-asv">https://pystatgen.github.io/sgkit-benchmarks-asv</a></p>
<p>You can run the benchmark suite locally with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asv</span> <span class="n">run</span> <span class="o">--</span><span class="n">config</span> <span class="n">benchmarks</span><span class="o">/</span><span class="n">asv</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>You can generate the html of the results via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asv</span> <span class="n">publish</span> <span class="o">--</span><span class="n">config</span> <span class="n">benchmarks</span><span class="o">/</span><span class="n">asv</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">v</span>
</pre></div>
</div>
<p>The resulting HTML files end up in the <code class="docutils literal notranslate"><span class="pre">benchmarks/html</span></code> directory and the
results in <code class="docutils literal notranslate"><span class="pre">benchmarks/results</span></code> directory.</p>
<p>You can see the results of the benchmarks in the browser by running a local
server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asv</span> <span class="n">preview</span> <span class="o">--</span><span class="n">config</span> <span class="n">benchmarks</span><span class="o">/</span><span class="n">asv</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">v</span>
</pre></div>
</div>
<p>The benchmark machine is the Github Actions machine, which has roughly the
following configurations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;arch&quot;</span><span class="p">:</span> <span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="s2">&quot;Intel(R) Xeon(R) Platinum 8272CL CPU @ 2.60GHz&quot;</span><span class="p">,</span>
    <span class="s2">&quot;machine&quot;</span><span class="p">:</span> <span class="s2">&quot;fv-az183-669&quot;</span><span class="p">,</span>
    <span class="s2">&quot;num_cpu&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;os&quot;</span><span class="p">:</span> <span class="s2">&quot;Linux 5.4.0-1039-azure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ram&quot;</span><span class="p">:</span> <span class="s2">&quot;7121276&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above configuration was determined by running the following command on
Github Actions, on one of the runs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asv</span> <span class="n">machine</span> <span class="o">--</span><span class="n">yes</span>
</pre></div>
</div>
<p>The configuration above does changes slightly in every run, for example we
could get a machine with different cpu like say the one with 2.30GHz or the one
with slightly less RAM (not a huge deviation from above though). As of now it
is not possible to fix this, unless we use a custom machine for benchmarking,
hence minor deviation in benchmarks performance should be consumed with a pinch
of salt.</p>
</div>
<div class="section" id="review-process">
<h2><a class="toc-backref" href="#id16">Review process</a><a class="headerlink" href="#review-process" title="Permalink to this headline">¶</a></h2>
<p>Pull requests will be reviewed by a project maintainer. All changes to <em>sgkit</em> require
approval by at least one maintainer.</p>
<p>We use <a class="reference external" href="https://mergify.io/">mergify</a> to automate PR flow. A project
[committer](<a class="reference external" href="https://github.com/orgs/pystatgen/teams/committers">https://github.com/orgs/pystatgen/teams/committers</a>) (reviewer) could decide
to automatically merge a PR by labeling it with <code class="docutils literal notranslate"><span class="pre">auto-merge</span></code>, and when the PR gets:
at least one +1 (from [committers](<a class="reference external" href="https://github.com/orgs/pystatgen/teams/committers">https://github.com/orgs/pystatgen/teams/committers</a>))
and a clean build it will get merged automatically.</p>
</div>
<div class="section" id="design-discussions">
<h2><a class="toc-backref" href="#id17">Design discussions</a><a class="headerlink" href="#design-discussions" title="Permalink to this headline">¶</a></h2>
<p>The information on these topics may be useful for developers in understanding the
history behind the design choices that have been made within the project so far.</p>
<div class="section" id="dataset-subclassing">
<h3><a class="toc-backref" href="#id18">Dataset subclassing</a><a class="headerlink" href="#dataset-subclassing" title="Permalink to this headline">¶</a></h3>
<p>Debates on whether or not we should use Xarray objects directly or
put them behind a layer of encapsulation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/pull/16#issuecomment-657725092">https://github.com/pystatgen/sgkit/pull/16#issuecomment-657725092</a></p></li>
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/pull/78#issuecomment-669878845">https://github.com/pystatgen/sgkit/pull/78#issuecomment-669878845</a></p></li>
</ul>
</div>
<div class="section" id="dataset-api-typing">
<h3><a class="toc-backref" href="#id19">Dataset API typing</a><a class="headerlink" href="#dataset-api-typing" title="Permalink to this headline">¶</a></h3>
<p>Discussions around bringing stricter array type enforcement into the API:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/issues/43">https://github.com/pystatgen/sgkit/issues/43</a></p></li>
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/pull/124">https://github.com/pystatgen/sgkit/pull/124</a></p></li>
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/pull/276">https://github.com/pystatgen/sgkit/pull/276</a></p></li>
</ul>
</div>
<div class="section" id="delayed-invariant-checks">
<h3><a class="toc-backref" href="#id20">Delayed invariant checks</a><a class="headerlink" href="#delayed-invariant-checks" title="Permalink to this headline">¶</a></h3>
<p>Discussions on how to run sanity checks on arrays efficiently and why those checks would be
useful if they were possible (they are not possible currently w/ Dask):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/issues/61">https://github.com/pystatgen/sgkit/issues/61</a></p></li>
<li><p><a class="reference external" href="https://github.com/dask/dask/issues/97">https://github.com/dask/dask/issues/97</a></p></li>
</ul>
</div>
<div class="section" id="mixed-ploidy">
<h3><a class="toc-backref" href="#id21">Mixed ploidy</a><a class="headerlink" href="#mixed-ploidy" title="Permalink to this headline">¶</a></h3>
<p>Proposal for handling mixed ploidy: <a class="reference external" href="https://github.com/pystatgen/sgkit/issues/243">https://github.com/pystatgen/sgkit/issues/243</a></p>
</div>
<div class="section" id="numba-guvectorize-usage">
<h3><a class="toc-backref" href="#id22">Numba guvectorize usage</a><a class="headerlink" href="#numba-guvectorize-usage" title="Permalink to this headline">¶</a></h3>
<p>Learning how to use <code class="docutils literal notranslate"><span class="pre">guvectorize</span></code> effectively:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/pull/114">https://github.com/pystatgen/sgkit/pull/114</a></p></li>
<li><p><a class="reference external" href="https://github.com/pystatgen/sgkit/pull/348">https://github.com/pystatgen/sgkit/pull/348</a></p></li>
</ul>
</div>
<div class="section" id="api-namespace">
<h3><a class="toc-backref" href="#id23">API namespace</a><a class="headerlink" href="#api-namespace" title="Permalink to this headline">¶</a></h3>
<p>Sgkit controls API namespace via init files. To accommodate for mypy and docstrings
we include both imports and <code class="docutils literal notranslate"><span class="pre">__all__</span></code> declaration. More on this decision in the issue:
<a class="reference external" href="https://github.com/pystatgen/sgkit/issues/251">https://github.com/pystatgen/sgkit/issues/251</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="vcf.html" class="btn btn-neutral float-left" title="Reading VCF" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, sgkit developers.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>